# Enable terminal 256 colour support
export TERM=xterm-256color
[ -n "$TMUX" ] && export TERM=screen-256color

export ENVIRONMENT=$HOME/Environment
SHELLLOC=$ENVIRONMENT/shell
BASH=$SHELLLOC/bash
ZSH=$SHELLLOC/zsh

cdir=$ENVIRONMENT/.cdir

export OS=$(lsb_release -si)

# Define the base PATH
export PATH="/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin:/usr/local/sbin"

echo "Loading shell essentials"
[ -r "$SHELLLOC/essentials.sh" ] && source "$SHELLLOC/essentials.sh"

add_path "$ENVIRONMENT/bin"
add_path "$HOME/.composer/vendor/bin"

echo "Loading general shell settings"
[ -r "$SHELLLOC/settings.sh" ] && source "$SHELLLOC/settings.sh"


if [ -r "$ENVIRONMENT/userspecific/shell/$SHELLNAME/before.$SHELLNAME" ]; then
    echo "Loading user settings (Before)"
    source "$ENVIRONMENT/userspecific/shell/$SHELLNAME/before.$SHELLNAME"
fi

echo "Loading general shellspecific settings"
[ -r "$SHELLLOC/$SHELLNAME/settings.$SHELLNAME" ] && source "$SHELLLOC/$SHELLNAME/settings.$SHELLNAME"

echo $SHELLLOC/$SHELLNAME/settings.$SHELLNAME

# Loading configs
echo "Loading general configs"
for file in $SHELLLOC/conf/*.sh; do
    echo "Loading config: ($file)"
    [ -r "$file" ] && source "$file"
done
unset file

# Loading configs
echo "Loading shellspecfic configs"
for file in $SHELLLOC/$SHELLNAME/conf/*.$SHELLNAME; do
    echo "Loading config: ($file)"
    [ -r "$file" ] && source "$file"
done
unset file

# Loading imported libraries
echo "Loading general libraries"
for file in $SHELLLOC/lib/*.sh; do
    echo "Loading library: ($file)"
    [ -r "$file" ] && source "$file"
done

# Loading imported libraries
echo "Loading shellspecific libraries"
for file in "$SHELLLOC/$SHELLNAME/lib/*.$SHELLNAME"; do
    echo "Loading library: ($file)"
    [ -r "$file" ] && source "$file"
done

if [ -r $ENVIRONMENT/userspecific/$SHELLNAME/after.$SHELLNAME ]; then
    echo "Loading userspecific settings (after)"
    source $ENVIRONMENT/userspecific/$SHELLNAME/after.$SHELLNAME
fi

[ -f $cdir ] && echo "cdir found (`cat $cdir`)" && cd "`cat $cdir`" && rm "$cdir"
clear

if hash archey 2>/dev/null; then
    archey
elif hash screenfetch 2>/dev/null; then
    screenfetch
fi
